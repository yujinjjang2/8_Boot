<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>공공데이터 연습</title>
</head>
<body>
    <h2>경찰 공무원 수 대비 범죄 발생률과 검거율 데이터 조회</h2>
	
	<button id = "btn1">목록 조회</button>
	<br><br>
	<table id = "resultTable" border = "1">
	        <thead id = "resultHead">
			<tr>
				<th>경찰서명</th>
				<th>총인구</th>
				<th>경찰인원</th>
				<th>주요 범죄 발생 카운트</th>
				<th>주요 범죄 검거 카운트</th>
			</tr>
		</thead>
		<tbody id = "resultBody">
		</tbody>
	</table>

    <script>
        const btn = document.getElementById("btn1");
        const resultBody = document.getElementById("resultBody");

        btn.addEventListener("click", () => {

            fetch("dataInfo")
            .then(res => res.json())
            .then(data => {

				console.log(data);
				
				// 필요한 것 까지 파고드는 부분 --> 중요!!!!!!!! (다 다름..)
				// 꼭 데이터 확인 후 만든거 키 값에 따라 파고드는 것임..
				const jsonData = data.getgnPolcCntVsCrmnlOccrrncRtNdArrstRtData.body.items.item;
				console.log(jsonData); // fetch내에서 반복문 돌아야할지 말아야할지도 잘 알아야 함!
				
				resultBody.innerHTML = "";
           	
           		// 배열이면 for문 돌면서 접근하는 것 --> 중요!!!!!!!
                for(let i in jsonData){
                   let item = jsonData[i];
  
                   const row = document.createElement("tr");
                   const polcsttn_nm = document.createElement("td");
                   polcsttn_nm.textContent = item.polcsttn_nm;
                   row.appendChild(polcsttn_nm);
                   
                   const tot_popltn = document.createElement("td");
                   tot_popltn.textContent = item.tot_popltn;
                   row.appendChild(tot_popltn);
                   
                   const polc_nmpr = document.createElement("td");
                   polc_nmpr.textContent = item.polc_nmpr;
                   row.appendChild(polc_nmpr);
                   
                   const five_main_crmnl_occrrnc_cnt = document.createElement("td");
                   five_main_crmnl_occrrnc_cnt.textContent = item.five_main_crmnl_occrrnc_cnt;
                   row.appendChild(five_main_crmnl_occrrnc_cnt);
                   
                   const five_main_crmnl_arrest_cnt = document.createElement("td");
                   five_main_crmnl_arrest_cnt.textContent = item.five_main_crmnl_arrest_cnt;
                   five_main_crmnl_arrest_cnt.style.textAlign = "right";
                   row.appendChild(five_main_crmnl_arrest_cnt);
                   
                   resultBody.appendChild(row);
                }

				
				

            })
            .catch(err => {
                console.log(err);
            })

        });

    </script>
</body>
</html>